type: grid
cards:
  - type: vertical-stack
    cards:
      - type: custom:stack-in-card
        cards:
          - type: custom:mushroom-media-player-card
            entity: media_player.edifier
            icon: mdi:play
            use_media_info: true
            show_volume_level: false
            media_controls: []
            volume_controls: []
            fill_container: false
            icon_type: none
            primary_info: none
            secondary_info: none
            card_mod:
              style: |
                mushroom-shape-icon {
                  display: flex;
                  {% set media_type = state_attr(config.entity, 'media_content_type') %}
                  {% if media_type == 'tvshow' %}
                    --card-mod-icon: mdi:television-classic;
                    animation: flicker 1s linear infinite alternate;
                  {% elif media_type == 'movie' %}
                    --card-mod-icon: mdi:movie-roll;
                    animation: spin 2s linear infinite reverse;
                  {% elif media_type == 'music' %}
                    --card-mod-icon: mdi:music;
                    animation: beat 1.3s ease-out infinite both;
                  {% elif media_type == 'playlist' %}
                    --card-mod-icon: mdi:music;
                    animation: beat 1.3s ease-out infinite both;
                  {% else %}
                    --card-mod-icon: mdi:play;
                  {% endif %}

                  {{ 'animation: none;' if not is_state(config.entity, 'off') }}

                }
                ha-card {
                  --ha-card-border-width: 0;
                }
                ha-card:before {
                  transform: translate3d(0,0,0);
                  -webkit-transform: translate3d(0,0,0);
                  content: "";

                  background: url('/local/edifier1.png') center no-repeat;
                  border-radius: 10px;
                  background-size: contain;
                  margin: 0px 0px 10px 0px;
                  {% set media_type = state_attr(config.entity, 'media_content_type') %}
                  {% if media_type == 'tvshow' %}
                    aspect-ratio: 16 / 9;
                  {% elif media_type == 'movie' %}
                    aspect-ratio: 2 / 3;
                  {% else %}
                    aspect-ratio: 1 / 1;
                  {% endif %}
                }
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:layout-card
                layout_type: custom:grid-layout
                layout:
                  grid-template-columns: auto 70px
                  margin: "-4px -4px -8px -4px;"
                cards:
                  - type: custom:mushroom-template-card
                    primary: Edifier R1280DB
                    secondary: "{{states(config.entity)}}"
                    icon: ""
                    picture: ""
                    badge_icon: ""
                    badge_color: ""
                    layout: horizontal
                    icon_color: ""
                    tap_action:
                      action: more-info
                    double_tap_action:
                      action: none
                    fill_container: true
                    entity: input_select.r1280db_source
                    card_mod:
                      style:
                        .: |
                          ha-card { 
                            margin-top: 0px;
                            margin-left: 0px;
                            margin-right: 0px;
                            background: transparent ;
                            }
                        mushroom-state-info$: |
                          .container {
                           --card-secondary-font-size: 12px;
                           --card-primary-font-size: 18px;
                           --card-secondary-color: rgba(255,255,255,0.7);
                          }
                  - type: custom:mushroom-template-card
                    primary: ""
                    secondary: ""
                    entity: input_boolean.akustika
                    tap_action:
                      action: toggle
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    icon: fas:power-off
                    icon_color: |2-
                            {%if is_state(config.entity,'on')%} red
                            {%else %} 
                            {% endif %}
                    picture: "{{state_attr(config.entity,'entity_picture')}}"
                    layout: horizontal
                    card_mod:
                      style:
                        mushroom-shape-icon$: |
                          .shape {
                            --shape-color: 

                               {% if is_state(config.entity, 'on')%} rgba(255,255,255,1)
                               {% else %} rgba(150,150,150,0.12)
                               {% endif %};
                        .: |
                          ha-card {
                          margin-top: 0px;
                            --icon-border-radius: 40% !important;
                            --icon-size: 45px;
                            background: none;
                          }
          - type: conditional
            conditions:
              - condition: state
                entity: input_boolean.akustika
                state: "on"
            card:
              type: custom:mushroom-chips-card
              chips:
                - type: template
                  icon: ""
                  content: ""
                  icon_color: ""
                  card_mod:
                    style: |
                      ha-card {
                        weight: 10%;
                        --chip-background: transparent;
                        --chip-height: 15px;
                      }
                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.akustika
                      state: "on"
                  chip:
                    type: template
                    content: M-Audio
                    tap_action:
                      action: perform-action
                      perform_action: script.line_1
                      target: {}
                    icon: mdi:audio-input-rca
                    icon_color: >-
                      {%if is_state('input_select.r1280db_source','M-Audio')%}
                      blue

                      {%else %} '1'

                      {% endif %}
                    card_mod:
                      style: |
                        ha-card {
                          --chip-background:             
                             {%if is_state('input_select.r1280db_source','M-Audio')%} white
                             {%else %} rgba(255,255,255,0.05)
                             {% endif %};
                          --text-color:
                             {%if is_state('input_select.r1280db_source','M-Audio')%} black
                             {%else %} 
                             {% endif %};
                          }
                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.akustika
                      state: "on"
                  chip:
                    type: template
                    content: PC
                    tap_action:
                      action: perform-action
                      perform_action: script.line_2
                      target: {}
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    icon: fas:computer
                    icon_color: |-
                      {% if is_state('input_select.r1280db_source','PC')%} blue
                      {% else %} '1'
                      {% endif %}
                    card_mod:
                      style: |
                        ha-card {
                          --chip-background:             
                             {%if is_state('input_select.r1280db_source','PC')%} white
                             {%else %} rgba(255,255,255,0.05)
                             {% endif %};
                          --text-color:
                             {%if is_state('input_select.r1280db_source','PC')%} black
                             {%else %} 
                             {% endif %};
                          }
                          }
                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.akustika
                      state: "on"
                  chip:
                    type: template
                    content: Bluetooth
                    tap_action:
                      action: perform-action
                      perform_action: script.bluetooth
                      target: {}
                    icon: mdi:bluetooth
                    icon_color: >-
                      {%if is_state('input_select.r1280db_source','Bluetooth')%}
                      blue

                      {%else %}  '1'

                      {% endif %}
                    card_mod:
                      style: |
                        ha-card {

                          --chip-background:             
                             {%if is_state('input_select.r1280db_source','Bluetooth')%} white
                             {%else %} rgba(255,255,255,0.05)
                             {% endif %};
                          --text-color:
                             {%if is_state('input_select.r1280db_source','Bluetooth')%} black
                             {%else %} 
                             {% endif %};
                          }
                - type: template
                  icon: ""
                  content: ""
                  icon_color: ""
                  card_mod:
                    style: |
                      ha-card {
                        weight: 10%;
                        --chip-background: transparent;
                        --chip-height: 15px;
                      }
              alignment: start
              card_mod:
                style: |
                  ha-card > .chip-container {
                    height: 60px;
                    flex-wrap: nowrap;
                    overflow-x: scroll;
                    overflow-y: hidden;
                    --chip-spacing: 10px;
                    --chip-height: 45px;
                    --chip-background: rgba(255,255,255,0.1) ;
                    --chip-font-weight: normal; 
                    --chip-font-size: 14px; 
                    margin-top: 5px;
                    margin-left: -20px;  
                    margin-right: -20px;
                    margin-bottom: -10px; 
                    padding-bottom: 0px;
                  }
                  ha-card > .chip-container > * {
                    flex-shrink: 0;
                  }
          - type: conditional
            conditions:
              - condition: state
                entity: input_boolean.akustika
                state: "on"
            card:
              type: custom:mushroom-chips-card
              chips:
                - type: template
                  tap_action:
                    action: perform-action
                    perform_action: script.volume_down
                    target: {}
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  icon: fas:volume-low
                - type: spacer
                - type: template
                  icon: fas:backward
                  tap_action:
                    action: perform-action
                    perform_action: media_player.media_previous_track
                    target:
                      entity_id: media_player.edifier
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                - type: template
                  tap_action:
                    action: perform-action
                    perform_action: script.play_pause
                    target: {}
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  icon: mdi:play-pause
                  icon_color: black
                  card_mod:
                    style: |
                      ha-card {
                        margin: -15px 0px 0px 0px;
                           --chip-background: rgba(255,255,255);
                           --chip-border-radius: 40%;
                           --chip-height: 75px;
                           --chip-padding: 20px;
                      }           
                - type: template
                  icon: fas:forward
                  tap_action:
                    action: perform-action
                    perform_action: media_player.media_next_track
                    target:
                      entity_id: media_player.edifier
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                - type: spacer
                - type: template
                  tap_action:
                    action: perform-action
                    perform_action: script.volume_up
                    target: {}
                  hold_action:
                    action: none
                  double_tap_action:
                    action: none
                  icon: fas:volume-high
              alignment: center
              card_mod:
                style: |
                  ha-card {
                       margin: 30px 12px 20px 12px;
                        --chip-background: none;
                        --chip-height: 50px;
                        --chip-padding: 20px;
                        --chip-spacing: 5px;
                  }
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                icon: mdi:information
                icon_color: 255,255,255,0.4
                tap_action:
                  action: more-info
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                entity: input_boolean.akustika
            alignment: end
            card_mod:
              style: |
                ha-card {
                  position: absolute !important;
                  bottom: 0px !important;
                  right: 0px !important;
                  background-color: none !important;
                  --chip-background: none !important;
                  --chip-height: 50px !important;
        card_mod:
          style: |
            ha-card:before {
              transform: translate3d(0,0,0);
              -webkit-transform: translate3d(0,0,0);
              content: "";
              position: absolute;
              height: 100%;
              width: 100%;

              background: url('/local/edifier1.png') center no-repeat;
              {% if is_state('media_player.edifier', 'on') %}
                background: url('/local/edifier1.png') center no-repeat;
              {% endif %}
              filter: blur(250px) saturate(200%);
              background-size: 100% 100%;
            }
            ha-card {
              padding: 20px;
              transform: translate3d(0,0,0);
              -webkit-transform: translate3d(0,0,0);
            }
